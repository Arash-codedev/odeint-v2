<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Class template symplectic_nystroem_stepper_base</title>
<link rel="stylesheet" href="../../../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="../../../index.html" title="Chapter&#160;1.&#160;Boost.Numeric.Odeint">
<link rel="up" href="../../../header/boost/numeric/odeint/stepper/base/symplectic_rkn_stepper_base_hpp.html" title="Header &lt;boost/numeric/odeint/stepper/base/symplectic_rkn_stepper_base.hpp&gt;">
<link rel="prev" href="../../../header/boost/numeric/odeint/stepper/base/symplectic_rkn_stepper_base_hpp.html" title="Header &lt;boost/numeric/odeint/stepper/base/symplectic_rkn_stepper_base.hpp&gt;">
<link rel="next" href="../../../header/boost/numeric/odeint/stepper/bulirsch_stoer_hpp.html" title="Header &lt;boost/numeric/odeint/stepper/bulirsch_stoer.hpp&gt;">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr><td valign="top"><img alt="" width="" height="" src="../../../logo.jpg"></td></tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="../../../header/boost/numeric/odeint/stepper/base/symplectic_rkn_stepper_base_hpp.html"><img src="../../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../../../header/boost/numeric/odeint/stepper/base/symplectic_rkn_stepper_base_hpp.html"><img src="../../../images/up.png" alt="Up"></a><a accesskey="h" href="../../../index.html"><img src="../../../images/home.png" alt="Home"></a><a accesskey="n" href="../../../header/boost/numeric/odeint/stepper/bulirsch_stoer_hpp.html"><img src="../../../images/next.png" alt="Next"></a>
</div>
<div class="refentry">
<a name="boost.numeric.odeint.symplectic_nys_idp20868000"></a><div class="titlepage"></div>
<div class="refnamediv">
<h2><span class="refentrytitle">Class template symplectic_nystroem_stepper_base</span></h2>
<p>boost::numeric::odeint::symplectic_nystroem_stepper_base &#8212; Base class for all symplectic steppers of Nystroem type. </p>
</div>
<h2 xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="refsynopsisdiv-title">Synopsis</h2>
<div xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="refsynopsisdiv"><pre class="synopsis"><span class="comment">// In header: &lt;<a class="link" href="../../../header/boost/numeric/odeint/stepper/base/symplectic_rkn_stepper_base_hpp.html" title="Header &lt;boost/numeric/odeint/stepper/base/symplectic_rkn_stepper_base.hpp&gt;">boost/numeric/odeint/stepper/base/symplectic_rkn_stepper_base.hpp</a>&gt;

</span><span class="keyword">template</span><span class="special">&lt;</span><span class="identifier">size_t</span> NumOfStages<span class="special">,</span> <span class="keyword">unsigned</span> <span class="keyword">short</span> Order<span class="special">,</span> <span class="keyword">typename</span> Coor<span class="special">,</span> 
         <span class="keyword">typename</span> Momentum<span class="special">,</span> <span class="keyword">typename</span> Value<span class="special">,</span> <span class="keyword">typename</span> CoorDeriv<span class="special">,</span> 
         <span class="keyword">typename</span> MomentumDeriv<span class="special">,</span> <span class="keyword">typename</span> Time<span class="special">,</span> <span class="keyword">typename</span> Algebra<span class="special">,</span> 
         <span class="keyword">typename</span> Operations<span class="special">,</span> <span class="keyword">typename</span> Resizer<span class="special">&gt;</span> 
<span class="keyword">class</span> <a class="link" href="symplectic_nys_idp20868000.html" title="Class template symplectic_nystroem_stepper_base">symplectic_nystroem_stepper_base</a> <span class="special">:</span>
  <span class="keyword">public</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">numeric</span><span class="special">::</span><span class="identifier">odeint</span><span class="special">::</span><span class="identifier">algebra_stepper_base</span><span class="special">&lt;</span> <span class="identifier">Algebra</span><span class="special">,</span> <span class="identifier">Operations</span> <span class="special">&gt;</span>
<span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
  <span class="comment">// types</span>
  <span class="keyword">typedef</span> <a class="link" href="algebra_stepper_base.html" title="Class template algebra_stepper_base">algebra_stepper_base</a><span class="special">&lt;</span> <span class="identifier">Algebra</span><span class="special">,</span> <span class="identifier">Operations</span> <span class="special">&gt;</span>       <a name="boost.numeric.odeint.symplectic_nys_idp20868000.algebra_stepper_base_type"></a><span class="identifier">algebra_stepper_base_type</span><span class="special">;</span>  
  <span class="keyword">typedef</span> <span class="identifier">algebra_stepper_base_type</span><span class="special">::</span><span class="identifier">algebra_type</span>           <a name="boost.numeric.odeint.symplectic_nys_idp20868000.algebra_type"></a><span class="identifier">algebra_type</span><span class="special">;</span>               
  <span class="keyword">typedef</span> <span class="identifier">algebra_stepper_base_type</span><span class="special">::</span><span class="identifier">operations_type</span>        <a name="boost.numeric.odeint.symplectic_nys_idp20868000.operations_type"></a><span class="identifier">operations_type</span><span class="special">;</span>            
  <span class="keyword">typedef</span> <span class="identifier">Coor</span>                                              <a name="boost.numeric.odeint.symplectic_nys_idp20868000.coor_type"></a><span class="identifier">coor_type</span><span class="special">;</span>                  
  <span class="keyword">typedef</span> <span class="identifier">Momentum</span>                                          <a name="boost.numeric.odeint.symplectic_nys_idp20868000.momentum_type"></a><span class="identifier">momentum_type</span><span class="special">;</span>              
  <span class="keyword">typedef</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">pair</span><span class="special">&lt;</span> <span class="identifier">coor_type</span><span class="special">,</span> <span class="identifier">momentum_type</span> <span class="special">&gt;</span>             <a name="boost.numeric.odeint.symplectic_nys_idp20868000.state_type"></a><span class="identifier">state_type</span><span class="special">;</span>                 
  <span class="keyword">typedef</span> <span class="identifier">CoorDeriv</span>                                         <a name="boost.numeric.odeint.symplectic_nys_idp20868000.coor_deriv_type"></a><span class="identifier">coor_deriv_type</span><span class="special">;</span>            
  <span class="keyword">typedef</span> <span class="identifier">state_wrapper</span><span class="special">&lt;</span> <span class="identifier">coor_deriv_type</span> <span class="special">&gt;</span>                  <a name="boost.numeric.odeint.symplectic_nys_idp20868000.wrapped_coor_deriv_type"></a><span class="identifier">wrapped_coor_deriv_type</span><span class="special">;</span>    
  <span class="keyword">typedef</span> <span class="identifier">MomentumDeriv</span>                                     <a name="boost.numeric.odeint.symplectic_nys_idp20868000.momentum_deriv_type"></a><span class="identifier">momentum_deriv_type</span><span class="special">;</span>        
  <span class="keyword">typedef</span> <span class="identifier">state_wrapper</span><span class="special">&lt;</span> <span class="identifier">momentum_deriv_type</span> <span class="special">&gt;</span>              <a name="boost.numeric.odeint.symplectic_nys_idp20868000.wrapped_moment_idp20896768"></a><span class="identifier">wrapped_momentum_deriv_type</span><span class="special">;</span>
  <span class="keyword">typedef</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">pair</span><span class="special">&lt;</span> <span class="identifier">coor_deriv_type</span><span class="special">,</span> <span class="identifier">momentum_deriv_type</span> <span class="special">&gt;</span> <a name="boost.numeric.odeint.symplectic_nys_idp20868000.deriv_type"></a><span class="identifier">deriv_type</span><span class="special">;</span>                 
  <span class="keyword">typedef</span> <span class="identifier">Value</span>                                             <a name="boost.numeric.odeint.symplectic_nys_idp20868000.value_type"></a><span class="identifier">value_type</span><span class="special">;</span>                 
  <span class="keyword">typedef</span> <span class="identifier">Time</span>                                              <a name="boost.numeric.odeint.symplectic_nys_idp20868000.time_type"></a><span class="identifier">time_type</span><span class="special">;</span>                  
  <span class="keyword">typedef</span> <span class="identifier">Resizer</span>                                           <a name="boost.numeric.odeint.symplectic_nys_idp20868000.resizer_type"></a><span class="identifier">resizer_type</span><span class="special">;</span>               
  <span class="keyword">typedef</span> <span class="identifier">stepper_tag</span>                                       <a name="boost.numeric.odeint.symplectic_nys_idp20868000.stepper_category"></a><span class="identifier">stepper_category</span><span class="special">;</span>           
  <span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">short</span>                                    <a name="boost.numeric.odeint.symplectic_nys_idp20868000.order_type"></a><span class="identifier">order_type</span><span class="special">;</span>                 
  <span class="keyword">typedef</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">array</span><span class="special">&lt;</span> <span class="identifier">value_type</span><span class="special">,</span> <span class="identifier">num_of_stages</span> <span class="special">&gt;</span>         <a name="boost.numeric.odeint.symplectic_nys_idp20868000.coef_type"></a><span class="identifier">coef_type</span><span class="special">;</span>                  

  <span class="comment">// <a class="link" href="symplectic_nys_idp20868000.html#boost.numeric.odeint.symplectic_nys_idp20868000construct-copy-destruct">construct/copy/destruct</a></span>
  <a class="link" href="symplectic_nys_idp20868000.html#idp20962352-bb"><span class="identifier">symplectic_nystroem_stepper_base</span></a><span class="special">(</span><span class="keyword">const</span> <span class="identifier">coef_type</span> <span class="special">&amp;</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">coef_type</span> <span class="special">&amp;</span><span class="special">,</span> 
                                   <span class="keyword">const</span> <span class="identifier">algebra_type</span> <span class="special">&amp;</span> <span class="special">=</span> <span class="identifier">algebra_type</span><span class="special">(</span><span class="special">)</span><span class="special">)</span><span class="special">;</span>

  <span class="comment">// <a class="link" href="symplectic_nys_idp20868000.html#idp20904288-bb">public member functions</a></span>
  <span class="identifier">order_type</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20904688-bb"><span class="identifier">order</span></a><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span>
  <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> StateInOut<span class="special">&gt;</span> 
    <span class="keyword">void</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20907184-bb"><span class="identifier">do_step</span></a><span class="special">(</span><span class="identifier">System</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">StateInOut</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">time_type</span><span class="special">,</span> <span class="identifier">time_type</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> StateInOut<span class="special">&gt;</span> 
    <span class="keyword">void</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20916576-bb"><span class="identifier">do_step</span></a><span class="special">(</span><span class="identifier">System</span><span class="special">,</span> <span class="identifier">StateInOut</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">time_type</span><span class="special">,</span> <span class="identifier">time_type</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> CoorInOut<span class="special">,</span> <span class="keyword">typename</span> MomentumInOut<span class="special">&gt;</span> 
    <span class="keyword">void</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20922112-bb"><span class="identifier">do_step</span></a><span class="special">(</span><span class="identifier">System</span><span class="special">,</span> <span class="identifier">CoorInOut</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">MomentumInOut</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">time_type</span><span class="special">,</span> <span class="identifier">time_type</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> CoorInOut<span class="special">,</span> <span class="keyword">typename</span> MomentumInOut<span class="special">&gt;</span> 
    <span class="keyword">void</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20933200-bb"><span class="identifier">do_step</span></a><span class="special">(</span><span class="identifier">System</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">CoorInOut</span> <span class="special">&amp;</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">MomentumInOut</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">time_type</span><span class="special">,</span> 
                 <span class="identifier">time_type</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> StateIn<span class="special">,</span> <span class="keyword">typename</span> StateOut<span class="special">&gt;</span> 
    <span class="keyword">void</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20940016-bb"><span class="identifier">do_step</span></a><span class="special">(</span><span class="identifier">System</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">StateIn</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">time_type</span><span class="special">,</span> <span class="identifier">StateOut</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">time_type</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> StateType<span class="special">&gt;</span> <span class="keyword">void</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20951040-bb"><span class="identifier">adjust_size</span></a><span class="special">(</span><span class="keyword">const</span> <span class="identifier">StateType</span> <span class="special">&amp;</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">const</span> <span class="identifier">coef_type</span> <span class="special">&amp;</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20954768-bb"><span class="identifier">coef_a</span></a><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span>
  <span class="keyword">const</span> <span class="identifier">coef_type</span> <span class="special">&amp;</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20956720-bb"><span class="identifier">coef_b</span></a><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span>
  <span class="identifier">algebra_type</span> <span class="special">&amp;</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20958672-bb"><span class="identifier">algebra</span></a><span class="special">(</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">const</span> <span class="identifier">algebra_type</span> <span class="special">&amp;</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20960512-bb"><span class="identifier">algebra</span></a><span class="special">(</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span>

  <span class="comment">// <a class="link" href="symplectic_nys_idp20868000.html#idp20968432-bb">private member functions</a></span>
  <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> StateIn<span class="special">,</span> <span class="keyword">typename</span> StateOut<span class="special">&gt;</span> 
    <span class="keyword">void</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20968848-bb"><span class="identifier">do_step_impl</span></a><span class="special">(</span><span class="identifier">System</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">StateIn</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">time_type</span><span class="special">,</span> <span class="identifier">StateOut</span> <span class="special">&amp;</span><span class="special">,</span> 
                      <span class="identifier">time_type</span><span class="special">,</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">mpl</span><span class="special">::</span><span class="identifier">true_</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> StateIn<span class="special">,</span> <span class="keyword">typename</span> StateOut<span class="special">&gt;</span> 
    <span class="keyword">void</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20975904-bb"><span class="identifier">do_step_impl</span></a><span class="special">(</span><span class="identifier">System</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">StateIn</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">time_type</span><span class="special">,</span> <span class="identifier">StateOut</span> <span class="special">&amp;</span><span class="special">,</span> 
                      <span class="identifier">time_type</span><span class="special">,</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">mpl</span><span class="special">::</span><span class="identifier">false_</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> StateIn<span class="special">&gt;</span> <span class="keyword">bool</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20982960-bb"><span class="identifier">resize_dqdt</span></a><span class="special">(</span><span class="keyword">const</span> <span class="identifier">StateIn</span> <span class="special">&amp;</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> StateIn<span class="special">&gt;</span> <span class="keyword">bool</span> <a class="link" href="symplectic_nys_idp20868000.html#idp20985456-bb"><span class="identifier">resize_dpdt</span></a><span class="special">(</span><span class="keyword">const</span> <span class="identifier">StateIn</span> <span class="special">&amp;</span><span class="special">)</span><span class="special">;</span>

  <span class="comment">// public data members</span>
  <span class="keyword">static</span> <span class="keyword">const</span> <span class="identifier">size_t</span> <span class="identifier">num_of_stages</span><span class="special">;</span>
  <span class="keyword">static</span> <span class="keyword">const</span> <span class="identifier">order_type</span> <span class="identifier">order_value</span><span class="special">;</span>
<span class="special">}</span><span class="special">;</span></pre></div>
<div class="refsect1">
<a name="idp22924592"></a><h2>Description</h2>
<p>This class is the base class for the symplectic Runge-Kutta-Nystroem steppers. Symplectic steppers are usually used to solve Hamiltonian systems and they conserve the phase space volume, see <a href="http://en.wikipedia.org/wiki/Symplectic_integrator" target="_top">en.wikipedia.org/wiki/Symplectic_integrator</a>. Furthermore, the energy is conserved in average. In detail this class of steppers can be used to solve separable Hamiltonian systems which can be written in the form H(q,p) = H1(p) + H2(q). q is usually called the coordinate, while p is the momentum. The equations of motion are dq/dt = dH1/dp, dp/dt = -dH2/dq.</p>
<p>ToDo : add formula for solver and explanation of the coefficients</p>
<p><a class="link" href="symplectic_nys_idp20868000.html" title="Class template symplectic_nystroem_stepper_base">symplectic_nystroem_stepper_base</a> uses odeints algebra and operation system. Step size and error estimation are not provided for this class of solvers. It derives from <a class="link" href="algebra_stepper_base.html" title="Class template algebra_stepper_base">algebra_stepper_base</a>. Several <code class="computeroutput">do_step</code> variants are provided:</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p><code class="computeroutput">do_step( sys , x , t , dt )</code> - The classical <code class="computeroutput">do_step</code> method. The sys can be either a pair of function objects for the coordinate or the momentum part or one function object for the momentum part. <code class="computeroutput">x</code> is a pair of coordinate and momentum. The state is updated in-place.</p></li>
<li class="listitem"><p><code class="computeroutput">do_step( sys , q , p , t , dt )</code> - This method is similar to the method above with the difference that the coordinate and the momentum are passed explicitly and not packed into a pair.</p></li>
<li class="listitem"><p><code class="computeroutput">do_step( sys , x_in , t , x_out , dt )</code> - This method transforms the state out-of-place. <code class="computeroutput">x_in</code> and <code class="computeroutput">x_out</code> are here pairs of coordinate and momentum.</p></li>
</ul></div>
<p>
</p>
<p>
</p>
<div class="refsect2">
<a name="idp22936640"></a><h3>Template Parameters</h3>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
<pre class="literallayout"><span class="identifier">size_t</span> NumOfStages</pre>
<p>Number of stages. </p>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">unsigned</span> <span class="keyword">short</span> Order</pre>
<p>The order of the stepper. </p>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">typename</span> Coor</pre>
<p>The type representing the coordinates q. </p>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">typename</span> Momentum</pre>
<p>The type representing the coordinates p. </p>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">typename</span> Value</pre>
<p>The basic value type. Should be something like float, double or a high-precision type. </p>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">typename</span> CoorDeriv</pre>
<p>The type representing the time derivative of the coordinate dq/dt. </p>
</li>
<li class="listitem"><pre class="literallayout"><span class="keyword">typename</span> MomentumDeriv</pre></li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">typename</span> Time</pre>
<p>The type representing the time t. </p>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">typename</span> Algebra</pre>
<p>The algebra. </p>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">typename</span> Operations</pre>
<p>The operations. </p>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">typename</span> Resizer</pre>
<p>The resizer policy. </p>
</li>
</ol></div>
</div>
<div class="refsect2">
<a name="idp22960912"></a><h3>
<a name="boost.numeric.odeint.symplectic_nys_idp20868000construct-copy-destruct"></a><code class="computeroutput">symplectic_nystroem_stepper_base</code> 
        public
       construct/copy/destruct</h3>
<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
<pre class="literallayout"><a name="idp20962352-bb"></a><span class="identifier">symplectic_nystroem_stepper_base</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">coef_type</span> <span class="special">&amp;</span> coef_a<span class="special">,</span> 
                                 <span class="keyword">const</span> <span class="identifier">coef_type</span> <span class="special">&amp;</span> coef_b<span class="special">,</span> 
                                 <span class="keyword">const</span> <span class="identifier">algebra_type</span> <span class="special">&amp;</span> algebra <span class="special">=</span> <span class="identifier">algebra_type</span><span class="special">(</span><span class="special">)</span><span class="special">)</span><span class="special">;</span></pre>Constructs a <code class="computeroutput"><a class="link" href="symplectic_nys_idp20868000.html" title="Class template symplectic_nystroem_stepper_base">symplectic_nystroem_stepper_base</a></code> class. The parameters of the specific Nystroem method and the algebra have to be passed. <p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><code class="computeroutput">algebra</code></span></p></td>
<td><p>A copy of algebra is made and stored inside <code class="computeroutput"><a class="link" href="explicit_stepper_base.html" title="Class template explicit_stepper_base">explicit_stepper_base</a></code>. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">coef_a</code></span></p></td>
<td><p>The coefficients a. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">coef_b</code></span></p></td>
<td><p>The coefficients b. </p></td>
</tr>
</tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li></ol></div>
</div>
<div class="refsect2">
<a name="idp22985440"></a><h3>
<a name="idp20904288-bb"></a><code class="computeroutput">symplectic_nystroem_stepper_base</code> public member functions</h3>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
<pre class="literallayout"><span class="identifier">order_type</span> <a name="idp20904688-bb"></a><span class="identifier">order</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span></pre>
<p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Returns:</span></p></td>
<td><p>Returns the order of the stepper. </p></td>
</tr></tbody>
</table></div>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> StateInOut<span class="special">&gt;</span> 
  <span class="keyword">void</span> <a name="idp20907184-bb"></a><span class="identifier">do_step</span><span class="special">(</span><span class="identifier">System</span> system<span class="special">,</span> <span class="keyword">const</span> <span class="identifier">StateInOut</span> <span class="special">&amp;</span> state<span class="special">,</span> <span class="identifier">time_type</span> t<span class="special">,</span> 
               <span class="identifier">time_type</span> dt<span class="special">)</span><span class="special">;</span></pre>This method performs one step. The system can be either a pair of two function object describing the momentum part and the coordinate part or one function object describing only the momentum part. In this case the coordinate is assumed to be trivial dq/dt = p. The state is updated in-place. <div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top">
<p>boost::ref or std::ref can be used for the system as well as for the state. So, it is correct to write <code class="computeroutput">stepper.do_step( make_pair( std::ref( fq ) , std::ref( fp ) ) , make_pair( std::ref( q ) , std::ref( p ) ) , t , dt )</code>.</p>
<p>This method solves the forwarding problem.</p>
</td></tr>
</table></div>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><code class="computeroutput">dt</code></span></p></td>
<td><p>The time step. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">state</code></span></p></td>
<td><p>The state of the ODE. It is a pair of Coor and Momentum. The state is updated in-place, therefore, the new value of the state will be written into this variable. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">system</code></span></p></td>
<td><p>The system, can be represented as a pair of two function object or one function object. See above. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">t</code></span></p></td>
<td><p>The time of the ODE. It is not advanced by this method. </p></td>
</tr>
</tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> StateInOut<span class="special">&gt;</span> 
  <span class="keyword">void</span> <a name="idp20916576-bb"></a><span class="identifier">do_step</span><span class="special">(</span><span class="identifier">System</span> system<span class="special">,</span> <span class="identifier">StateInOut</span> <span class="special">&amp;</span> state<span class="special">,</span> <span class="identifier">time_type</span> t<span class="special">,</span> <span class="identifier">time_type</span> dt<span class="special">)</span><span class="special">;</span></pre>Same function as above. It differs only in a different const specifier in order to solve the forwarding problem, can be used with Boost.Range. </li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> CoorInOut<span class="special">,</span> <span class="keyword">typename</span> MomentumInOut<span class="special">&gt;</span> 
  <span class="keyword">void</span> <a name="idp20922112-bb"></a><span class="identifier">do_step</span><span class="special">(</span><span class="identifier">System</span> system<span class="special">,</span> <span class="identifier">CoorInOut</span> <span class="special">&amp;</span> q<span class="special">,</span> <span class="identifier">MomentumInOut</span> <span class="special">&amp;</span> p<span class="special">,</span> <span class="identifier">time_type</span> t<span class="special">,</span> 
               <span class="identifier">time_type</span> dt<span class="special">)</span><span class="special">;</span></pre>This method performs one step. The system can be either a pair of two function object describing the momentum part and the coordinate part or one function object describing only the momentum part. In this case the coordinate is assumed to be trivial dq/dt = p. The state is updated in-place. <div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top">
<p>boost::ref or std::ref can be used for the system. So, it is correct to write <code class="computeroutput">stepper.do_step( make_pair( std::ref( fq ) , std::ref( fp ) ) , q , p , t , dt )</code>.</p>
<p>This method solves the forwarding problem.</p>
</td></tr>
</table></div>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><code class="computeroutput">dt</code></span></p></td>
<td><p>The time step. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">p</code></span></p></td>
<td><p>The momentum of the ODE. It is updated in-place. Therefore, the new value of the momentum will be written info this variable. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">q</code></span></p></td>
<td><p>The coordinate of the ODE. It is updated in-place. Therefore, the new value of the coordinate will be written into this variable. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">system</code></span></p></td>
<td><p>The system, can be represented as a pair of two function object or one function object. See above. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">t</code></span></p></td>
<td><p>The time of the ODE. It is not advanced by this method. </p></td>
</tr>
</tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> CoorInOut<span class="special">,</span> <span class="keyword">typename</span> MomentumInOut<span class="special">&gt;</span> 
  <span class="keyword">void</span> <a name="idp20933200-bb"></a><span class="identifier">do_step</span><span class="special">(</span><span class="identifier">System</span> system<span class="special">,</span> <span class="keyword">const</span> <span class="identifier">CoorInOut</span> <span class="special">&amp;</span> q<span class="special">,</span> <span class="keyword">const</span> <span class="identifier">MomentumInOut</span> <span class="special">&amp;</span> p<span class="special">,</span> 
               <span class="identifier">time_type</span> t<span class="special">,</span> <span class="identifier">time_type</span> dt<span class="special">)</span><span class="special">;</span></pre>Same function as do_step( system , q , p , t , dt ). It differs only in a different const specifier in order to solve the forwarding problem, can be called with Boost.Range. </li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> StateIn<span class="special">,</span> <span class="keyword">typename</span> StateOut<span class="special">&gt;</span> 
  <span class="keyword">void</span> <a name="idp20940016-bb"></a><span class="identifier">do_step</span><span class="special">(</span><span class="identifier">System</span> system<span class="special">,</span> <span class="keyword">const</span> <span class="identifier">StateIn</span> <span class="special">&amp;</span> in<span class="special">,</span> <span class="identifier">time_type</span> t<span class="special">,</span> <span class="identifier">StateOut</span> <span class="special">&amp;</span> out<span class="special">,</span> 
               <span class="identifier">time_type</span> dt<span class="special">)</span><span class="special">;</span></pre>This method performs one step. The system can be either a pair of two function object describing the momentum part and the coordinate part or one function object describing only the momentum part. In this case the coordinate is assumed to be trivial dq/dt = p. The state is updated out-of-place. <div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top">
<p>boost::ref or std::ref can be used for the system. So, it is correct to write <code class="computeroutput">stepper.do_step( make_pair( std::ref( fq ) , std::ref( fp ) ) , x_in , t , x_out , dt )</code>.</p>
<p>This method NOT solve the forwarding problem.</p>
</td></tr>
</table></div>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><code class="computeroutput">dt</code></span></p></td>
<td><p>The time step. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">in</code></span></p></td>
<td><p>The state of the ODE, which is a pair of coordinate and momentum. The state is updated out-of-place, therefore the new value is written into out </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">out</code></span></p></td>
<td><p>The new state of the ODE. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">system</code></span></p></td>
<td><p>The system, can be represented as a pair of two function object or one function object. See above. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">t</code></span></p></td>
<td><p>The time of the ODE. It is not advanced by this method. </p></td>
</tr>
</tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> StateType<span class="special">&gt;</span> <span class="keyword">void</span> <a name="idp20951040-bb"></a><span class="identifier">adjust_size</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">StateType</span> <span class="special">&amp;</span> x<span class="special">)</span><span class="special">;</span></pre>Adjust the size of all temporaries in the stepper manually. <p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><code class="computeroutput">x</code></span></p></td>
<td><p>A state from which the size of the temporaries to be resized is deduced. </p></td>
</tr></tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">const</span> <span class="identifier">coef_type</span> <span class="special">&amp;</span> <a name="idp20954768-bb"></a><span class="identifier">coef_a</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span></pre>Returns the coefficients a. </li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">const</span> <span class="identifier">coef_type</span> <span class="special">&amp;</span> <a name="idp20956720-bb"></a><span class="identifier">coef_b</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span></pre>Returns the coefficients b. </li>
<li class="listitem">
<pre class="literallayout"><span class="identifier">algebra_type</span> <span class="special">&amp;</span> <a name="idp20958672-bb"></a><span class="identifier">algebra</span><span class="special">(</span><span class="special">)</span><span class="special">;</span></pre>
<p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Returns:</span></p></td>
<td><p>A reference to the algebra which is held by this class. </p></td>
</tr></tbody>
</table></div>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">const</span> <span class="identifier">algebra_type</span> <span class="special">&amp;</span> <a name="idp20960512-bb"></a><span class="identifier">algebra</span><span class="special">(</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span></pre>
<p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Returns:</span></p></td>
<td><p>A const reference to the algebra which is held by this class. </p></td>
</tr></tbody>
</table></div>
</li>
</ol></div>
</div>
<div class="refsect2">
<a name="idp23148096"></a><h3>
<a name="idp20968432-bb"></a><code class="computeroutput">symplectic_nystroem_stepper_base</code> private member functions</h3>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem"><pre class="literallayout"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> StateIn<span class="special">,</span> <span class="keyword">typename</span> StateOut<span class="special">&gt;</span> 
  <span class="keyword">void</span> <a name="idp20968848-bb"></a><span class="identifier">do_step_impl</span><span class="special">(</span><span class="identifier">System</span> system<span class="special">,</span> <span class="keyword">const</span> <span class="identifier">StateIn</span> <span class="special">&amp;</span> in<span class="special">,</span> <span class="identifier">time_type</span> t<span class="special">,</span> 
                    <span class="identifier">StateOut</span> <span class="special">&amp;</span> out<span class="special">,</span> <span class="identifier">time_type</span> dt<span class="special">,</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">mpl</span><span class="special">::</span><span class="identifier">true_</span><span class="special">)</span><span class="special">;</span></pre></li>
<li class="listitem"><pre class="literallayout"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> System<span class="special">,</span> <span class="keyword">typename</span> StateIn<span class="special">,</span> <span class="keyword">typename</span> StateOut<span class="special">&gt;</span> 
  <span class="keyword">void</span> <a name="idp20975904-bb"></a><span class="identifier">do_step_impl</span><span class="special">(</span><span class="identifier">System</span> system<span class="special">,</span> <span class="keyword">const</span> <span class="identifier">StateIn</span> <span class="special">&amp;</span> in<span class="special">,</span> <span class="identifier">time_type</span><span class="special">,</span> 
                    <span class="identifier">StateOut</span> <span class="special">&amp;</span> out<span class="special">,</span> <span class="identifier">time_type</span> dt<span class="special">,</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">mpl</span><span class="special">::</span><span class="identifier">false_</span><span class="special">)</span><span class="special">;</span></pre></li>
<li class="listitem"><pre class="literallayout"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> StateIn<span class="special">&gt;</span> <span class="keyword">bool</span> <a name="idp20982960-bb"></a><span class="identifier">resize_dqdt</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">StateIn</span> <span class="special">&amp;</span> x<span class="special">)</span><span class="special">;</span></pre></li>
<li class="listitem"><pre class="literallayout"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> StateIn<span class="special">&gt;</span> <span class="keyword">bool</span> <a name="idp20985456-bb"></a><span class="identifier">resize_dpdt</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">StateIn</span> <span class="special">&amp;</span> x<span class="special">)</span><span class="special">;</span></pre></li>
</ol></div>
</div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2009-2012 Karsten
      Ahnert and Mario Mulansky<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="../../../header/boost/numeric/odeint/stepper/base/symplectic_rkn_stepper_base_hpp.html"><img src="../../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../../../header/boost/numeric/odeint/stepper/base/symplectic_rkn_stepper_base_hpp.html"><img src="../../../images/up.png" alt="Up"></a><a accesskey="h" href="../../../index.html"><img src="../../../images/home.png" alt="Home"></a><a accesskey="n" href="../../../header/boost/numeric/odeint/stepper/bulirsch_stoer_hpp.html"><img src="../../../images/next.png" alt="Next"></a>
</div>
</body>
</html>
